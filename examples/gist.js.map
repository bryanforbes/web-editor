{"version":3,"file":"gist.js","sourceRoot":"","sources":["../../src/examples/gist.ts"],"names":[],"mappings":"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","sourcesContent":["import Route from '@dojo/routing/Route';\nimport Map from '@dojo/shim/Map';\nimport Editor from '../Editor';\nimport project from '../project';\nimport Runner from '../Runner';\nimport { getByUsername, getById } from '../support/gists';\nimport router, { GistParameters } from './router';\n\nconst titleH2 = document.getElementById('title') as HTMLHeadingElement;\nconst githubUsernameDiv = document.getElementById('github-username') as HTMLDivElement;\nconst usernameInput = document.getElementById('username') as HTMLInputElement;\nconst loadGistsButton = document.getElementById('load-gists') as HTMLButtonElement;\nconst projectListDiv = document.getElementById('project-list') as HTMLDivElement;\nconst projectSelect = document.getElementById('project') as HTMLSelectElement;\nconst loadProjectButton = document.getElementById('load-project') as HTMLButtonElement;\nconst fileListDiv = document.getElementById('file-list') as HTMLDivElement;\nconst selectFileSelect = document.getElementById('select-file') as HTMLSelectElement;\nconst runButton = document.getElementById('run') as HTMLButtonElement;\n\nconst editorDiv = document.getElementById('editor') as HTMLDivElement;\nconst runnerIframe = document.getElementById('runner') as HTMLIFrameElement;\n\nconst editor = new Editor(editorDiv);\nconst runner = new Runner(runnerIframe);\n\nconst gistIDMap = new Map<string, string>();\n\nasync function runButtonClick(evt: Event) {\n\tevt.preventDefault();\n\trunButton.setAttribute('disabled', 'disabled');\n\tawait runner.run();\n\trunButton.removeAttribute('disabled');\n}\n\nfunction selectFileSelectChange(evt: Event) {\n\tevt.preventDefault();\n\teditor.display(selectFileSelect.value);\n}\n\nasync function loadProject(filename: string) {\n\tawait project.load(filename);\n\tconst projectBundle = project.get()!;\n\tconsole.log(`Loaded. Project contains ${projectBundle.files.length + projectBundle.environmentFiles.length} files.`);\n\n\t/* generate UI for selecting a file */\n\tproject.getFileNames()\n\t\t.sort((a, b) => a < b ? -1 : 1)\n\t\t.forEach((name) => {\n\t\t\tconst option = document.createElement('option');\n\t\t\toption.value = name;\n\t\t\toption.text = name;\n\t\t\tselectFileSelect.appendChild(option);\n\t\t});\n\n\tselectFileSelect.addEventListener('change', selectFileSelectChange);\n\teditor.display(selectFileSelect.value);\n\n\trunButton.addEventListener('click', runButtonClick);\n\n\tfileListDiv.classList.remove('hidden');\n}\n\nasync function loadProjectButtonClick() {\n\tprojectSelect.setAttribute('disabled', 'disabled');\n\tloadProjectButton.setAttribute('disabled', 'disabled');\n\tawait loadProject(projectSelect.value);\n\ttitleH2.textContent = projectSelect.selectedOptions[0].text;\n\trouter.setPath(gistIDMap.get(projectSelect.value!)!);\n}\n\nasync function loadGistsButtonClick() {\n\tconst username = usernameInput.value;\n\tconsole.log(`Loading gists for \"${username}\"...`);\n\tif (!username) {\n\t\treturn;\n\t}\n\tloadGistsButton.setAttribute('disabled', 'disabled');\n\tconst gists = await getByUsername(username);\n\tif (!gists.length) {\n\t\tconsole.warn('No valid gists found.');\n\t\tloadGistsButton.removeAttribute('disabled');\n\t\treturn;\n\t}\n\tloadGistsButton.removeEventListener('click', loadGistsButtonClick);\n\tgists.forEach(({ description, id, projectJson }) => {\n\t\tconst option = document.createElement('option');\n\t\toption.value = projectJson;\n\t\toption.text = description;\n\t\tgistIDMap.set(projectJson, id);\n\t\tprojectSelect.appendChild(option);\n\t});\n\tloadProjectButton.addEventListener('click', loadProjectButtonClick);\n\tprojectListDiv.classList.remove('hidden');\n}\n\nrouter.append(new Route({\n\tpath: '/',\n\n\tasync exec() {\n\t\tloadGistsButton.addEventListener('click', loadGistsButtonClick);\n\t\tgithubUsernameDiv.classList.remove('hidden');\n\t}\n}));\n\nrouter.append(new Route<any, GistParameters>({\n\tpath: '/{id}',\n\n\tasync exec(request) {\n\t\tif (!project.isLoaded()) {\n\t\t\tconst { id } = request.params;\n\t\t\tconst gist = await getById(id);\n\t\t\tif (gist) {\n\t\t\t\ttitleH2.textContent = gist.description;\n\t\t\t\tawait loadProject(gist.projectJson);\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttitleH2.textContent = '[Unfound Gist]';\n\t\t\t}\n\t\t}\n\t}\n}));\n\nrouter.start();\n"]}