{"version":3,"file":"registerCustomElement.js","sourceRoot":"","sources":["registerCustomElement.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;IAAA,mDAAsG;IAetG;;;;;;OAMG;IACH,+BAAsC,iBAAiD;QACtF,IAAM,UAAU,GAAG,iBAAiB,EAAE,CAAC;QACvC,IAAI,cAA+B,CAAC;QAEpC,cAAc,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO;YAAgB,2BAAW;YAClE;gBAAA,YACC,iBAAO,SAGP;gBADA,kCAAiB,CAAC,KAAI,CAAC,CAAC;;YACzB,CAAC;YAED,0CAAwB,GAAxB,UAAyB,IAAY,EAAE,QAAuB,EAAE,QAAuB;gBACtF,uCAAsB,CAAC,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;YACxD,CAAC;YAED,mCAAiB,GAAjB;gBACC,MAAM,CAAC,cAAc,CAAC;YACvB,CAAC;YAED,mCAAiB,GAAjB,UAAkB,MAAuB;gBACxC,cAAc,GAAG,MAAM,CAAC;YACzB,CAAC;YAED,sCAAoB,GAApB;gBACC,MAAM,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,iBAAiB,CAAC;YAC/C,CAAC;YAED,+BAAa,GAAb;gBACC,MAAM,CAAC,UAAU,CAAC;YACnB,CAAC;YAED,sBAAW,6BAAkB;qBAA7B;oBACC,MAAM,CAAC,CAAC,UAAU,CAAC,UAAU,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,UAAA,SAAS,IAAI,OAAA,SAAS,CAAC,aAAa,EAAvB,CAAuB,CAAC,CAAC;gBAChF,CAAC;;;eAAA;YACF,cAAC;QAAD,CAAC,AA9ByC,CAAc,WAAW,GA8BjE,CAAC;IACJ,CAAC;IAnCD,sDAmCC;IAED,kBAAe,qBAAqB,CAAC","sourcesContent":["import { initializeElement, CustomElementDescriptor, handleAttributeChanged } from './customElements';\nimport { Constructor, WidgetProperties } from './interfaces';\nimport { WidgetBase } from './WidgetBase';\n\ndeclare namespace customElements {\n\tfunction define(name: string, constructor: any): void;\n}\n\n/**\n * Describes a function that returns a CustomElementDescriptor\n */\nexport interface CustomElementDescriptorFactory {\n\t(): CustomElementDescriptor;\n}\n\n/**\n * Register a custom element using the v1 spec of custom elements. Note that\n * this is the default export, and, expects the proposal to work in the browser.\n * This will likely require the polyfill and native shim.\n *\n * @param descriptorFactory\n */\nexport function registerCustomElement(descriptorFactory: CustomElementDescriptorFactory) {\n\tconst descriptor = descriptorFactory();\n\tlet widgetInstance: WidgetBase<any>;\n\n\tcustomElements.define(descriptor.tagName, class extends HTMLElement {\n\t\tconstructor() {\n\t\t\tsuper();\n\n\t\t\tinitializeElement(this);\n\t\t}\n\n\t\tattributeChangedCallback(name: string, oldValue: string | null, newValue: string | null) {\n\t\t\thandleAttributeChanged(this, name, newValue, oldValue);\n\t\t}\n\n\t\tgetWidgetInstance(): WidgetBase<any> {\n\t\t\treturn widgetInstance;\n\t\t}\n\n\t\tsetWidgetInstance(widget: WidgetBase<any>): void {\n\t\t\twidgetInstance = widget;\n\t\t}\n\n\t\tgetWidgetConstructor(): Constructor<WidgetBase<WidgetProperties>> {\n\t\t\treturn this.getDescriptor().widgetConstructor;\n\t\t}\n\n\t\tgetDescriptor(): CustomElementDescriptor {\n\t\t\treturn descriptor;\n\t\t}\n\n\t\tstatic get observedAttributes(): string[] {\n\t\t\treturn (descriptor.attributes || []).map(attribute => attribute.attributeName);\n\t\t}\n\t});\n}\n\nexport default registerCustomElement;\n"]}