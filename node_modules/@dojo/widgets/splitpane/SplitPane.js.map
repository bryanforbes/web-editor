{"version":3,"file":"SplitPane.js","sourceRoot":"","sources":["SplitPane.ts"],"names":[],"mappings":"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","sourcesContent":["import { createHandle } from '@dojo/core/lang';\nimport { DNode } from '@dojo/widget-core/interfaces';\nimport { ThemeableMixin, ThemeableProperties, theme } from '@dojo/widget-core/mixins/Themeable';\nimport { v } from '@dojo/widget-core/d';\nimport { WidgetBase } from '@dojo/widget-core/WidgetBase';\n\nimport * as css from './styles/splitPane.m.css';\n\n/**\n * Direction of this SplitPane\n */\nexport const enum Direction {\n\tcolumn,\n\trow\n};\n\n/**\n * @type SplitPaneProperties\n *\n * Properties that can be set on a SplitPane component\n *\n * @property direction      Orientation of this SplitPane, can be `row` or `column`\n * @property leading        Content to show in the primary pane\n * @property onResize       Called when the divider is dragged; should be used to update `size`\n * @property size           Size of the primary pane\n * @property trailing       Content to show in the secondary pane\n */\nexport interface SplitPaneProperties extends ThemeableProperties {\n\tdirection?: Direction;\n\tleading?: DNode;\n\tonResize?(size: number): void;\n\tsize?: number;\n\ttrailing?: DNode;\n};\n\nexport const SplitPaneBase = ThemeableMixin(WidgetBase);\n\nconst DEFAULT_SIZE = 100;\n\n@theme(css)\nexport default class SplitPane extends SplitPaneBase<SplitPaneProperties> {\n\tprivate _divider: HTMLElement;\n\tprivate _dragging: boolean;\n\tprivate _lastSize?: number;\n\tprivate _position: number;\n\tprivate _root: HTMLElement;\n\tprivate _boundHandlers: any[];\n\n\tconstructor() {\n\t\t/* istanbul ignore next: disregard transpiled `super`'s \"else\" block */\n\t\tsuper();\n\n\t\t/**\n\t\t * `mouseup` and other events aren't triggered when a user's cursor leaves div.root, so\n\t\t * global handlers are need to listen to the document instead. SplitPane\n\t\t * uses a `_dragging` flag so no handlers will be erroneously executed\n\t\t * if a user isn't actually resizing this SplitPane instance.\n\t\t */\n\t\tthis._boundHandlers = [];\n\t\t[\n\t\t\t{ event: 'mouseup', func: this._onDragEnd.bind(this) },\n\t\t\t{ event: 'mousemove', func: this._onDragMove.bind(this) },\n\t\t\t{ event: 'touchmove', func: this._onDragMove.bind(this) }\n\t\t].forEach(object => {\n\t\t\tdocument.addEventListener(object.event, object.func);\n\t\t\tthis._boundHandlers.push(object);\n\t\t});\n\n\t\tthis.own(createHandle(() => {\n\t\t\tthis._boundHandlers.forEach(object => document.removeEventListener(object.event, object.func));\n\t\t}));\n\t}\n\n\tprivate _deselect() {\n\t\tconst selection = window.getSelection();\n\t\tselection.removeAllRanges();\n\t}\n\n\tprivate _getPosition(event: MouseEvent & TouchEvent) {\n\t\tconst { direction = Direction.row } = this.properties;\n\n\t\tif (direction === Direction.row) {\n\t\t\treturn event.changedTouches ? event.changedTouches[0].clientX : event.clientX;\n\t\t}\n\t\telse {\n\t\t\treturn event.changedTouches ? event.changedTouches[0].clientY : event.clientY;\n\t\t}\n\t}\n\n\tprivate _onDragStart(event: MouseEvent & TouchEvent) {\n\t\tthis._dragging = true;\n\t\tthis._position = this._getPosition(event);\n\t\tthis._deselect();\n\t}\n\n\tprivate _onDragMove(event: MouseEvent & TouchEvent) {\n\t\tif (!this._dragging) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._deselect();\n\n\t\tconst {\n\t\t\tdirection = Direction.row,\n\t\t\tonResize,\n\t\t\tsize = DEFAULT_SIZE\n\t\t} = this.properties;\n\n\t\tconst currentPosition = this._getPosition(event);\n\t\tlet newSize = (this._lastSize === undefined ? size : this._lastSize) + currentPosition - this._position;\n\n\t\tconst maxSize = direction === Direction.row ?\n\t\t\tthis._root.offsetWidth - this._divider.offsetWidth :\n\t\t\tthis._root.offsetHeight - this._divider.offsetHeight;\n\n\t\tthis._lastSize = newSize;\n\n\t\tnewSize = newSize < 0 ? 0 : newSize;\n\t\tnewSize = newSize > maxSize ? maxSize : newSize;\n\n\t\tthis._position = currentPosition;\n\n\t\tonResize && onResize(newSize);\n\t}\n\n\tprivate _onDragEnd(event: MouseEvent & TouchEvent) {\n\t\tthis._dragging = false;\n\t\tthis._lastSize = undefined;\n\t}\n\n\tprotected onElementCreated(element: HTMLElement, key: string) {\n\t\tif (key === 'root') {\n\t\t\tthis._root = element;\n\t\t}\n\t\tif (key === 'divider') {\n\t\t\tthis._divider = element;\n\t\t}\n\t}\n\n\trender(): DNode {\n\t\tconst {\n\t\t\tdirection = Direction.row,\n\t\t\tleading = null,\n\t\t\tsize = DEFAULT_SIZE,\n\t\t\ttrailing = null\n\t\t} = this.properties;\n\n\t\tconst styles: {[key: string]: string} = {};\n\t\tstyles[direction === Direction.row ? 'width' : 'height'] = `${size}px`;\n\n\t\treturn v('div', {\n\t\t\tclasses: this.classes(\n\t\t\t\tcss.root,\n\t\t\t\tdirection === Direction.column ? css.column : css.row\n\t\t\t).fixed(\n\t\t\t\tcss.rootFixed,\n\t\t\t\tdirection === Direction.column ? css.columnFixed : css.rowFixed\n\t\t\t),\n\t\t\tkey: 'root'\n\t\t}, [\n\t\t\tv('div', {\n\t\t\t\tclasses: this.classes(\n\t\t\t\t\tcss.leading\n\t\t\t\t).fixed(\n\t\t\t\t\tcss.leadingFixed\n\t\t\t\t),\n\t\t\t\tkey: 'leading',\n\t\t\t\tstyles\n\t\t\t}, [ leading ]),\n\t\t\tv('div', {\n\t\t\t\tclasses: this.classes(\n\t\t\t\t\tcss.divider\n\t\t\t\t).fixed(\n\t\t\t\t\tcss.dividerFixed\n\t\t\t\t),\n\t\t\t\tkey: 'divider',\n\t\t\t\tonmousedown: this._onDragStart,\n\t\t\t\tontouchend: this._onDragEnd,\n\t\t\t\tontouchstart: this._onDragStart\n\t\t\t}),\n\t\t\tv('div', {\n\t\t\t\tclasses: this.classes(\n\t\t\t\t\tcss.trailing\n\t\t\t\t).fixed(\n\t\t\t\t\tcss.trailingFixed\n\t\t\t\t),\n\t\t\t\tkey: 'trailing'\n\t\t\t}, [ trailing ])\n\t\t]);\n\t}\n}\n"]}