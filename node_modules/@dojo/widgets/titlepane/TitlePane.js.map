{"version":3,"file":"TitlePane.js","sourceRoot":"","sources":["TitlePane.ts"],"names":[],"mappings":"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","sourcesContent":["import uuid from '@dojo/core/uuid';\nimport { DNode } from '@dojo/widget-core/interfaces';\nimport { theme, ThemeableMixin, ThemeableProperties } from '@dojo/widget-core/mixins/Themeable';\nimport { v } from '@dojo/widget-core/d';\nimport { WidgetBase } from '@dojo/widget-core/WidgetBase';\n\nimport { Keys } from '../common/util';\n\nimport * as css from './styles/titlePane.m.css';\nimport * as iconCss from '../common/styles/icons.m.css';\n\n/**\n * @type TitlePaneProperties\n *\n * Properties that can be set on a TitlePane component\n *\n * @property closeable          If false the pane will not collapse in response to clicking the title\n * @property headingLevel       'aria-level' for the title's DOM node\n * @property onRequestClose     Called when the title of an open pane is clicked\n * @property onRequestOpen      Called when the title of a closed pane is clicked\n * @property open               If true the pane is opened and content is visible\n * @property title              Title to display above the content\n */\nexport interface TitlePaneProperties extends ThemeableProperties {\n\tcloseable?: boolean;\n\theadingLevel?: number;\n\tonRequestClose?(titlePane: TitlePane): void;\n\tonRequestOpen?(titlePane: TitlePane): void;\n\topen?: boolean;\n\ttitle: string;\n};\n\nexport const TitlePaneBase = ThemeableMixin(WidgetBase);\n\n@theme(css)\n@theme(iconCss)\nexport default class TitlePane extends TitlePaneBase<TitlePaneProperties> {\n\tprivate _contentId = uuid();\n\tprivate _titleId = uuid();\n\n\tprivate _afterRender(element: HTMLElement) {\n\t\t// Conditionally adjust top margin. Done manually instead of through Maquette\n\t\t// so the underlying DOM is accessible, as we need to know the content height.\n\t\t// Put in a rAF to push this operation to the next tick, otherwise\n\t\t// element.offsetHeight can be incorrect (e.g. before styling is applied)\n\t\t// Note that this will go away when meta support is added to widget-core\n\t\trequestAnimationFrame(() => {\n\t\t\tconst { open = true } = this.properties;\n\t\t\tconst height = element.offsetHeight;\n\t\t\telement.style.marginTop = open ? '0px' : `-${ height }px`;\n\t\t});\n\t}\n\n\tprivate _onTitleClick() {\n\t\tthis._toggle();\n\t}\n\n\tprivate _onTitleKeyUp(event: KeyboardEvent) {\n\t\tconst {keyCode } = event;\n\n\t\tif (keyCode === Keys.Enter || keyCode === Keys.Space) {\n\t\t\tthis._toggle();\n\t\t}\n\t}\n\n\tprivate _toggle() {\n\t\tconst {\n\t\t\tcloseable = true,\n\t\t\tonRequestClose,\n\t\t\tonRequestOpen,\n\t\t\topen = true\n\t\t} = this.properties;\n\n\t\tif (!closeable) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (open) {\n\t\t\tonRequestClose && onRequestClose(this);\n\t\t}\n\t\telse {\n\t\t\tonRequestOpen && onRequestOpen(this);\n\t\t}\n\t}\n\n\tprotected onElementCreated(element: HTMLElement, key: string) {\n\t\tkey === 'content' && this._afterRender(element);\n\t}\n\n\tprotected onElementUpdated(element: HTMLElement, key: string) {\n\t\tkey === 'content' && this._afterRender(element);\n\t}\n\n\trender(): DNode {\n\t\tconst {\n\t\t\tcloseable = true,\n\t\t\theadingLevel,\n\t\t\topen = true,\n\t\t\ttitle\n\t\t} = this.properties;\n\n\t\treturn v('div', {\n\t\t\tclasses: this.classes(\n\t\t\t\tcss.root,\n\t\t\t\topen ? css.open : null\n\t\t\t).fixed(css.rootFixed)\n\t\t}, [\n\t\t\tv('div', {\n\t\t\t\t'aria-level': headingLevel ? String(headingLevel) : null,\n\t\t\t\tclasses: this.classes(\n\t\t\t\t\tcloseable ? css.closeable : null,\n\t\t\t\t\tcss.title\n\t\t\t\t).fixed(\n\t\t\t\t\tcloseable ? css.closeableFixed : null,\n\t\t\t\t\tcss.titleFixed\n\t\t\t\t),\n\t\t\t\tonclick: this._onTitleClick,\n\t\t\t\tonkeyup: this._onTitleKeyUp,\n\t\t\t\trole: 'heading'\n\t\t\t}, [\n\t\t\t\tv('div', {\n\t\t\t\t\t'aria-controls': this._contentId,\n\t\t\t\t\t'aria-disabled': closeable ? null : 'true',\n\t\t\t\t\t'aria-expanded': String(open),\n\t\t\t\t\tclasses: this.classes(css.titleButton),\n\t\t\t\t\tid: this._titleId,\n\t\t\t\t\trole: 'button',\n\t\t\t\t\ttabIndex: closeable ? 0 : -1\n\t\t\t\t}, [\n\t\t\t\t\tv('i', {\n\t\t\t\t\t\tclasses: this.classes(\n\t\t\t\t\t\t\tcss.arrow,\n\t\t\t\t\t\t\ticonCss.icon,\n\t\t\t\t\t\t\topen ? iconCss.downIcon : iconCss.rightIcon\n\t\t\t\t\t\t),\n\t\t\t\t\t\trole: 'presentation',\n\t\t\t\t\t\t'aria-hidden': 'true'\n\t\t\t\t\t}),\n\t\t\t\t\ttitle\n\t\t\t\t])\n\t\t\t]),\n\t\t\tv('div', {\n\t\t\t\t'aria-hidden': open ? null : 'true',\n\t\t\t\t'aria-labelledby': this._titleId,\n\t\t\t\tclasses: this.classes(css.content),\n\t\t\t\tid: this._contentId,\n\t\t\t\tkey: 'content'\n\t\t\t}, this.children)\n\t\t]);\n\t}\n}\n"]}