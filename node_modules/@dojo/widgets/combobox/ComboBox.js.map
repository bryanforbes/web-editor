{"version":3,"file":"ComboBox.js","sourceRoot":"","sources":["ComboBox.ts"],"names":[],"mappings":"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","sourcesContent":["import { DNode, WNode, PropertiesChangeEvent } from '@dojo/widget-core/interfaces';\nimport { includes } from '@dojo/shim/array';\nimport { ThemeableMixin, ThemeableProperties, theme } from '@dojo/widget-core/mixins/Themeable';\nimport { v, w } from '@dojo/widget-core/d';\nimport { WidgetBase, onPropertiesChanged } from '@dojo/widget-core/WidgetBase';\nimport Label, { LabelOptions } from '../label/Label';\nimport ResultItem from './ResultItem';\nimport ResultMenu from './ResultMenu';\nimport TextInput, { TextInputProperties } from '../textinput/TextInput';\nimport uuid from '@dojo/core/uuid';\nimport WidgetRegistry from '@dojo/widget-core/WidgetRegistry';\nimport { Keys } from '../common/util';\n\nimport * as css from './styles/comboBox.m.css';\nimport * as iconCss from '../common/styles/icons.m.css';\n\n/**\n * @type ComboBoxProperties\n *\n * Properties that can be set on a ComboBox component\n *\n * @property autoBlur           Determines whether the input should blur after value selection\n * @property clearable          Determines whether the input should be able to be cleared\n * @property customResultItem   Can be used to render a custom result\n * @property customResultMenu   Can be used to render a custom result menu\n * @property disabled           Prevents user interaction and styles content accordingly\n * @property formId             ID of a form element associated with the form field\n * @property getResultLabel     Can be used to get the text label of a result based on the underlying result object\n * @property inputProperties    TextInput properties to set on the underlying input\n * @property invalid            Determines if this input is valid\n * @property isResultDisabled   Used to determine if an item should be disabled\n * @property label              Label to show for this input\n * @property onBlur             Called when the input is blurred\n * @property onChange           Called when the value changes\n * @property onFocus            Called when the input is focused\n * @property onMenuChange       Called when menu visibility changes\n * @property onRequestResults   Called when results are shown; should be used to set `results`\n * @property openOnFocus        Determines whether the result list should open when the input is focused\n * @property readOnly           Prevents user interaction\n * @property required           Determines if this input is required, styles accordingly\n * @property results            Results for the current search term; should be set in response to `onRequestResults`\n * @property value              Value to set on the input\n */\nexport interface ComboBoxProperties extends ThemeableProperties {\n\tautoBlur?: boolean;\n\tclearable?: boolean;\n\tcustomResultItem?: any;\n\tcustomResultMenu?: any;\n\tdisabled?: boolean;\n\tformId?: string;\n\tgetResultLabel?(result: any): string;\n\tinputProperties?: TextInputProperties;\n\tinvalid?: boolean;\n\tisResultDisabled?(result: any): boolean;\n\tlabel?: string | LabelOptions;\n\tonBlur?(value: string): void;\n\tonChange?(value: string): void;\n\tonFocus?(value: string): void;\n\tonMenuChange?(open: boolean): void;\n\tonRequestResults?(value: string): void;\n\topenOnFocus?: boolean;\n\treadOnly?: boolean;\n\trequired?: boolean;\n\tresults?: any[];\n\tvalue?: string;\n};\n\n// Enum used when traversing items using arrow keys\nexport const enum Operation {\n\tincrease = 1,\n\tdecrease = -1\n};\n\nexport const ComboBoxBase = ThemeableMixin(WidgetBase);\n\n@theme(css)\n@theme(iconCss)\nexport default class ComboBox extends ComboBoxBase<ComboBoxProperties> {\n\tprivate _activeIndex: number | undefined;\n\tprivate _focused: boolean;\n\tprivate _ignoreBlur: boolean;\n\tprivate _ignoreFocus: boolean;\n\tprivate _inputElement: HTMLInputElement;\n\tprivate _menuId = uuid();\n\tprivate _open: boolean;\n\tprivate _wasOpen: boolean;\n\tprivate _registry: WidgetRegistry;\n\n\tprivate _closeMenu() {\n\t\tthis._open = false;\n\t\tthis.invalidate();\n\t}\n\n\tprivate _createRegistry(customResultItem: any, customResultMenu: any) {\n\t\tconst registry = new WidgetRegistry();\n\t\tregistry.define('result-item', customResultItem);\n\t\tregistry.define('result-menu', customResultMenu);\n\n\t\treturn registry;\n\t}\n\n\tprivate _getResultLabel(result: any) {\n\t\tconst { getResultLabel } = this.properties;\n\n\t\treturn getResultLabel ? getResultLabel(result) : result;\n\t}\n\n\tprivate _isIndexDisabled(index: number) {\n\t\tconst {\n\t\t\tisResultDisabled,\n\t\t\tresults = []\n\t\t} = this.properties;\n\n\t\treturn isResultDisabled && isResultDisabled(results[index]);\n\t}\n\n\tprivate _onArrowClick() {\n\t\tconst {\n\t\t\tdisabled,\n\t\t\treadOnly\n\t\t} = this.properties;\n\n\t\t!disabled && !readOnly && this._openMenu();\n\t}\n\n\tprivate _onClearClick() {\n\t\tconst { onChange } = this.properties;\n\n\t\tthis._focused = true;\n\t\tonChange && onChange('');\n\t}\n\n\tprivate _onInput(event: Event) {\n\t\tconst { onChange } = this.properties;\n\n\t\tthis._activeIndex = undefined;\n\t\tonChange && onChange((<HTMLInputElement> event.target).value);\n\t\tthis._openMenu();\n\t}\n\n\tprivate _onInputBlur(event: FocusEvent) {\n\t\tconst { onBlur } = this.properties;\n\n\t\tif (this._ignoreBlur) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._focused = false;\n\t\tonBlur && onBlur((<HTMLInputElement> event.target).value);\n\t\tthis._closeMenu();\n\t}\n\n\tprivate _onInputFocus(event: FocusEvent) {\n\t\tconst {\n\t\t\tonFocus,\n\t\t\topenOnFocus\n\t\t} = this.properties;\n\n\t\tthis._focused = true;\n\t\tonFocus && onFocus((<HTMLInputElement> event.target).value);\n\t\topenOnFocus && !this._ignoreFocus && this._openMenu();\n\t\tthis._ignoreBlur = false;\n\t\tthis._ignoreFocus = false;\n\t}\n\n\tprivate _onInputKeyDown(event: KeyboardEvent) {\n\t\tconst { results = [] } = this.properties;\n\n\t\tswitch (event.which) {\n\t\t\tcase Keys.Up:\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis._moveActiveIndex(Operation.decrease);\n\t\t\t\tbreak;\n\t\t\tcase Keys.Down:\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis._open ? this._moveActiveIndex(Operation.increase) : this._openMenu();\n\t\t\t\tbreak;\n\t\t\tcase Keys.Escape:\n\t\t\t\tthis._open && this._closeMenu();\n\t\t\t\tbreak;\n\t\t\tcase Keys.Enter:\n\t\t\t\tif (this._open && results.length > 0) {\n\t\t\t\t\tthis._activeIndex === undefined ? this._closeMenu() : this._selectIndex(this._activeIndex);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _onMenuChange() {\n\t\tconst { onMenuChange } = this.properties;\n\n\t\tif (!onMenuChange) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._open && !this._wasOpen && onMenuChange(true);\n\t\t!this._open && this._wasOpen && onMenuChange(false);\n\t}\n\n\tprivate _onResultMouseDown() {\n\t\t// Maintain underlying input focus on next render\n\t\tthis._ignoreBlur = true;\n\t}\n\n\tprivate _onResultMouseEnter(event: MouseEvent, index: number) {\n\t\tif (this._isIndexDisabled(index)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._activeIndex = index;\n\t\tthis.invalidate();\n\t}\n\n\tprivate _onResultMouseUp(event: MouseEvent, index: number) {\n\t\tif (!this._isIndexDisabled(index)) {\n\t\t\tthis._ignoreFocus = true;\n\t\t\tthis._selectIndex(index);\n\t\t}\n\t}\n\n\tprivate _openMenu() {\n\t\tconst { onRequestResults } = this.properties;\n\n\t\tthis._activeIndex = undefined;\n\t\tthis._open = true;\n\t\tthis._focused = true;\n\t\tonRequestResults && onRequestResults(this._inputElement.value);\n\t}\n\n\tprivate _restoreFocus() {\n\t\tconst func = this._focused ? 'focus' : 'blur';\n\t\tthis._inputElement[func]();\n\t}\n\n\tprivate _scrollIntoView(element: HTMLElement) {\n\t\tconst menu = <HTMLElement> element.parentElement;\n\t\t// Scroll menu up so top of highlighted result aligns with top of menu container\n\t\tif (element.offsetTop - menu.scrollTop < 0) {\n\t\t\tmenu.scrollTop = element.offsetTop;\n\t\t}\n\t\t// Scroll menu down so bottom of highlighted result aligns with bottom of menu container\n\t\telse if ((element.offsetTop - menu.scrollTop + element.offsetHeight) > menu.clientHeight) {\n\t\t\tmenu.scrollTop = element.offsetTop - menu.clientHeight + element.offsetHeight;\n\t\t}\n\t}\n\n\tprivate _selectIndex(index: number) {\n\t\tconst {\n\t\t\tautoBlur,\n\t\t\tonChange,\n\t\t\tresults = []\n\t\t} = this.properties;\n\n\t\tthis._focused = !autoBlur;\n\t\tthis._closeMenu();\n\t\tonChange && onChange(this._getResultLabel(results[index]));\n\t}\n\n\tprivate _moveActiveIndex(operation: Operation) {\n\t\tconst { results = [] } = this.properties;\n\n\t\tif (results.length === 0) {\n\t\t\tthis._activeIndex = 0;\n\t\t\tthis.invalidate();\n\t\t\treturn;\n\t\t}\n\t\tif (results.every((result, i) => Boolean(this._isIndexDisabled(i)))) {\n\t\t\treturn;\n\t\t}\n\n\t\tfunction nextIndex(i?: number) {\n\t\t\tconst total = results.length;\n\t\t\tconst base = operation === Operation.increase ? 0 : -1;\n\t\t\tconst current = i !== undefined ? i + operation : base;\n\t\t\treturn (current + total) % total;\n\t\t}\n\n\t\tlet index = nextIndex(this._activeIndex);\n\n\t\twhile (this._isIndexDisabled(index)) {\n\t\t\tindex = nextIndex(index);\n\t\t}\n\n\t\tthis._activeIndex = index;\n\t\tthis.invalidate();\n\t}\n\n\tprotected onElementCreated(element: HTMLElement, key: string) {\n\t\tif (key === 'root') {\n\t\t\tthis._inputElement = <HTMLInputElement> element.querySelector('input');\n\t\t\tthis._restoreFocus();\n\t\t}\n\t}\n\n\tprotected onElementUpdated(element: HTMLElement, key: string) {\n\t\tif (key === 'root') {\n\t\t\tthis._restoreFocus();\n\t\t\tconst selectedResult = element.querySelector('[data-selected=\"true\"]');\n\t\t\tselectedResult && this._scrollIntoView(<HTMLElement> selectedResult);\n\t\t}\n\t}\n\n\t@onPropertiesChanged()\n\tprotected onPropertiesChanged(evt: PropertiesChangeEvent<this, ComboBoxProperties>) {\n\t\tconst {\n\t\t\tcustomResultItem = ResultItem,\n\t\t\tcustomResultMenu = ResultMenu\n\t\t} = this.properties;\n\n\t\tif (\n\t\t\t!this._registry ||\n\t\t\tincludes(evt.changedPropertyKeys, 'customResultItem') ||\n\t\t\tincludes(evt.changedPropertyKeys, 'customResultMenu')) {\n\n\t\t\tconst registry = this._createRegistry(customResultItem, customResultMenu);\n\t\t\tif (this._registry) {\n\t\t\t\tthis.registries.replace(this._registry, registry);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.registries.add(registry);\n\t\t\t}\n\t\t\tthis._registry = registry;\n\t\t}\n\t}\n\n\tprotected renderMenu(results: any[]): WNode | null {\n\t\tconst { theme = {}, isResultDisabled } = this.properties;\n\n\t\tif (results.length === 0 || !this._open) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn w<ResultMenu>('result-menu', {\n\t\t\tgetResultLabel: this._getResultLabel,\n\t\t\tid: this._menuId,\n\t\t\tisResultDisabled,\n\t\t\tonResultMouseDown: this._onResultMouseDown,\n\t\t\tonResultMouseEnter: this._onResultMouseEnter,\n\t\t\tonResultMouseUp: this._onResultMouseUp,\n\t\t\tregistry: this._registry,\n\t\t\tresults,\n\t\t\tselectedIndex: this._activeIndex,\n\t\t\ttheme\n\t\t});\n\t}\n\n\trender(): DNode {\n\t\tconst {\n\t\t\tclearable,\n\t\t\tdisabled,\n\t\t\tformId,\n\t\t\tinputProperties = {},\n\t\t\tinvalid,\n\t\t\tlabel,\n\t\t\treadOnly,\n\t\t\trequired,\n\t\t\tresults = [],\n\t\t\tvalue = '',\n\t\t\ttheme = {}\n\t\t} = this.properties;\n\n\t\tconst menu = this.renderMenu(results);\n\t\tconst menuId = menu ? this._menuId : '';\n\t\tthis._onMenuChange();\n\t\tthis._wasOpen = this._open;\n\n\t\tlet controls: DNode = v('div', {\n\t\t\tclasses: this.classes(css.controls)\n\t\t}, [\n\t\t\tw(TextInput, <TextInputProperties> {\n\t\t\t\t...inputProperties,\n\t\t\t\tclasses: this.classes(clearable ? css.clearable : null),\n\t\t\t\tcontrols: menuId,\n\t\t\t\tdisabled,\n\t\t\t\textraClasses: css,\n\t\t\t\tinvalid,\n\t\t\t\tonBlur: this._onInputBlur,\n\t\t\t\tonFocus: this._onInputFocus,\n\t\t\t\tonInput: this._onInput,\n\t\t\t\tonKeyDown: this._onInputKeyDown,\n\t\t\t\treadOnly,\n\t\t\t\trequired,\n\t\t\t\ttheme,\n\t\t\t\tvalue\n\t\t\t}),\n\t\t\tclearable ? v('button', {\n\t\t\t\t'aria-controls': menuId,\n\t\t\t\tclasses: this.classes(css.clear),\n\t\t\t\tdisabled,\n\t\t\t\treadOnly,\n\t\t\t\tonclick: this._onClearClick\n\t\t\t}, [\n\t\t\t\t'clear combo box',\n\t\t\t\tv('i', { classes: this.classes(iconCss.icon, iconCss.timesIcon),\n\t\t\t\t\trole: 'presentation', 'aria-hidden': 'true'\n\t\t\t\t})\n\t\t\t]) : null,\n\t\t\tv('button', {\n\t\t\t\t'aria-controls': menuId,\n\t\t\t\tclasses: this.classes(css.trigger),\n\t\t\t\tdisabled,\n\t\t\t\treadOnly,\n\t\t\t\tonclick: this._onArrowClick\n\t\t\t}, [\n\t\t\t\t'open combo box',\n\t\t\t\tv('i', { classes: this.classes(iconCss.icon, iconCss.downIcon),\n\t\t\t\t\trole: 'presentation', 'aria-hidden': 'true'\n\t\t\t\t})\n\t\t\t])\n\t\t]);\n\n\t\tif (label) {\n\t\t\tcontrols = w(Label, {\n\t\t\t\tformId,\n\t\t\t\tlabel\n\t\t\t}, [ controls ]);\n\t\t}\n\n\t\treturn v('div', {\n\t\t\t'aria-expanded': this._open ? 'true' : 'false',\n\t\t\t'aria-haspopup': 'true',\n\t\t\t'aria-readonly': readOnly ? 'true' : 'false',\n\t\t\t'aria-required': required ? 'true' : 'false',\n\t\t\tclasses: this.classes(css.root),\n\t\t\tkey: 'root',\n\t\t\trole: 'combobox'\n\t\t}, [\n\t\t\tcontrols,\n\t\t\tmenu\n\t\t]);\n\t}\n}\n"]}