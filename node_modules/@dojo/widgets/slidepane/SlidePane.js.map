{"version":3,"file":"SlidePane.js","sourceRoot":"","sources":["SlidePane.ts"],"names":[],"mappings":"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","sourcesContent":["import { DNode } from '@dojo/widget-core/interfaces';\nimport { ThemeableMixin, ThemeableProperties, theme } from '@dojo/widget-core/mixins/Themeable';\nimport { v } from '@dojo/widget-core/d';\nimport { WidgetBase } from '@dojo/widget-core/WidgetBase';\nimport * as animations from '../common/styles/animations.m.css';\nimport * as css from './styles/slidePane.m.css';\n\n/**\n * Enum for left / right alignment\n */\nexport const enum Align {\n\tleft,\n\tright\n};\n\n/**\n * @type SlidePaneProperties\n *\n * Properties that can be set on a SlidePane component\n *\n * @property align            The position of the pane on the screen (Align.left or Align.right)\n * @property onOpen           Called when the pane opens\n * @property onRequestClose   Called when the pane is swiped closed or the underlay is clicked or tapped\n * @property open             Determines whether the pane is open or closed\n * @property underlay         Determines whether a semi-transparent background shows behind the pane\n * @property width            Width of the pane in pixels\n */\nexport interface SlidePaneProperties extends ThemeableProperties {\n\talign?: Align;\n\tonOpen?(): void;\n\tonRequestClose?(): void;\n\topen?: boolean;\n\tunderlay?: boolean;\n\twidth?: number;\n};\n\n/**\n * The default width of the slide pane\n */\nconst DEFAULT_WIDTH = 256;\n\n/**\n * The minimum swipe delta in px required to be counted as a swipe and not a touch / click\n */\nconst SWIPE_THRESHOLD = 5;\n\nexport const SlidePaneBase = ThemeableMixin(WidgetBase);\n\n@theme(css)\nexport default class SlidePane extends SlidePaneBase<SlidePaneProperties> {\n\tprivate _content: HTMLElement;\n\tprivate _initialX: number;\n\tprivate _slideIn: boolean;\n\tprivate _swiping: boolean;\n\tprivate _transform: number;\n\tprivate _wasOpen: boolean;\n\n\tprivate _onSwipeStart(event: MouseEvent & TouchEvent) {\n\t\tthis._swiping = true;\n\t\t// Cache initial pointer position\n\t\tthis._initialX = event.type === 'touchstart' ? event.changedTouches[0].screenX : event.pageX;\n\t\t// Clear out the last transform applied\n\t\tthis._transform = 0;\n\t}\n\n\tprivate _onSwipeMove(event: MouseEvent & TouchEvent) {\n\t\t// Ignore mouse movement when not clicking\n\t\tif (!this._swiping) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst {\n\t\t\talign = Align.left,\n\t\t\twidth = DEFAULT_WIDTH\n\t\t} = this.properties;\n\n\t\t// Current pointer position\n\t\tconst currentX = event.type === 'touchmove' ? event.changedTouches[0].screenX : event.pageX;\n\t\t// Difference between current and initial pointer position\n\t\tconst delta = align === Align.right ? currentX - this._initialX : this._initialX - currentX;\n\t\t// Transform to apply\n\t\tthis._transform = 100 * delta / width;\n\n\t\t// Prevent pane from sliding past screen edge\n\t\tif (delta <= 0) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Move the pane\n\t\tthis._content.style.transform = `translateX(${ align === Align.left ? '-' : '' }${ this._transform }%)`;\n\t}\n\n\tprivate _onSwipeEnd(event: MouseEvent & TouchEvent) {\n\t\tconst { changedTouches, pageX, target, type } = event;\n\t\tthis._swiping = false;\n\n\t\tconst {\n\t\t\talign = Align.left,\n\t\t\tonRequestClose,\n\t\t\twidth = DEFAULT_WIDTH\n\t\t} = this.properties;\n\n\t\t// Current pointer position\n\t\tconst currentX = type === 'touchend' ? changedTouches[0].screenX : pageX;\n\t\t// Difference between current and initial pointer position\n\t\tconst delta = align === Align.right ? currentX - this._initialX : this._initialX - currentX;\n\n\t\t// If the pane was swiped far enough to close\n\t\tif (delta > width / 2) {\n\t\t\t// Cache the transform to apply on next render\n\t\t\tthis._transform = 100 * delta / width;\n\t\t\tonRequestClose && onRequestClose();\n\t\t}\n\t\t// If the underlay was clicked\n\t\telse if (Math.abs(delta) < SWIPE_THRESHOLD && (!this._content || !this._content.contains(target as HTMLElement))) {\n\t\t\tonRequestClose && onRequestClose();\n\t\t}\n\t\t// If pane was not swiped far enough to close\n\t\telse if (delta > 0) {\n\t\t\t// Animate the pane back open\n\t\t\tthis._slideIn = true;\n\t\t\tthis.invalidate();\n\t\t}\n\t}\n\n\tprotected onElementCreated(element: HTMLElement, key: string) {\n\t\tif (key === 'content') {\n\t\t\telement.addEventListener('transitionend', this.invalidate.bind(this));\n\t\t\tthis._content = element;\n\t\t}\n\t}\n\n\trender(): DNode {\n\t\tconst {\n\t\t\talign = Align.left,\n\t\t\tonOpen,\n\t\t\topen = false,\n\t\t\tunderlay = false,\n\t\t\twidth = DEFAULT_WIDTH\n\t\t} = this.properties;\n\n\t\tconst contentClasses = [\n\t\t\tcss.content,\n\t\t\talign === Align.left ? css.left : css.right,\n\t\t\topen ? css.open : null,\n\t\t\tthis._slideIn || (open && !this._wasOpen) ? css.slideIn : null,\n\t\t\t!open && this._wasOpen ? css.slideOut : null\n\t\t];\n\n\t\tconst contentStyles: {[key: string]: any} = {\n\t\t\ttransform: '',\n\t\t\twidth: width + 'px'\n\t\t};\n\n\t\tif (!open && this._wasOpen && this._transform) {\n\t\t\t// If pane is closing because of swipe\n\t\t\tcontentStyles['transform'] = `translateX(${ align === Align.left ? '-' : '' }${ this._transform }%)`;\n\t\t}\n\t\telse if (this._slideIn && this._content) {\n\t\t\tthis._content.style.transform = '';\n\t\t}\n\n\t\topen && !this._wasOpen && onOpen && onOpen();\n\t\tthis._wasOpen = open;\n\t\tthis._slideIn = false;\n\n\t\treturn v('div', {\n\t\t\tclasses: this.classes(css.root),\n\t\t\tonmousedown: this._onSwipeStart,\n\t\t\tonmousemove: this._onSwipeMove,\n\t\t\tonmouseup: this._onSwipeEnd,\n\t\t\tontouchend: this._onSwipeEnd,\n\t\t\tontouchmove: this._onSwipeMove,\n\t\t\tontouchstart: this._onSwipeStart\n\t\t}, [\n\t\t\topen ? v('div', {\n\t\t\t\tclasses: this.classes(underlay ? css.underlayVisible : null).fixed(css.underlay),\n\t\t\t\tenterAnimation: animations.fadeIn,\n\t\t\t\texitAnimation: animations.fadeOut,\n\t\t\t\tkey: 'underlay'\n\t\t\t}) : null,\n\t\t\tv('div', {\n\t\t\t\tkey: 'content',\n\t\t\t\tclasses: this.classes(...contentClasses),\n\t\t\t\tstyles: contentStyles\n\t\t\t}, this.children)\n\t\t]);\n\t}\n}\n"]}